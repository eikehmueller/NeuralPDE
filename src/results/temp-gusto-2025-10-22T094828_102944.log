2025-10-22 09:48:28,395 INFO     Running train.py
2025-10-22 09:48:36,753 ERROR    Gusto is logging this unhandled exception:
Traceback (most recent call last):
  File "/home/katie795/NeuralPDE_workspace/NeuralPDE/src/train.py", line 71, in <module>
    model = build_model(
            ^^^^^^^^^^^^
  File "/home/katie795/NeuralPDE_workspace/NeuralPDE/src/neural_pde/model.py", line 35, in build_model
    model.setup(
  File "/home/katie795/NeuralPDE_workspace/NeuralPDE/src/neural_pde/model.py", line 157, in setup
    PatchEncoder(
  File "/home/katie795/NeuralPDE_workspace/NeuralPDE/src/neural_pde/patch_encoder.py", line 90, in __init__
    self._function_to_patch = Interpolator(
                              ^^^^^^^^^^^^^
  File "/home/katie795/NeuralPDE_workspace/NeuralPDE/src/neural_pde/intergrid.py", line 67, in __init__
    torch_interpolation_tensor(
  File "/home/katie795/NeuralPDE_workspace/NeuralPDE/src/neural_pde/intergrid.py", line 35, in torch_interpolation_tensor
    u_to = assemble(interpolate(u_from, fs_to))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/firedrake/__future__.py", line 46, in interpolate
    return Interpolator(expr, V, *args, **kwargs).interpolate(default_missing_val=default_missing_val)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 81, in inner
    return func(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/firedrake/interpolation.py", line 832, in __init__
    self.callable, arguments = make_interpolator(expr, V, subset, access, bcs=bcs)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "petsc4py/PETSc/Log.pyx", line 250, in petsc4py.PETSc.Log.EventDecorator.decorator.wrapped_func
  File "petsc4py/PETSc/Log.pyx", line 251, in petsc4py.PETSc.Log.EventDecorator.decorator.wrapped_func
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/firedrake/interpolation.py", line 1021, in make_interpolator
    loops.extend(_interpolator(V, tensor, expr, subset, arguments, access, bcs=bcs))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<decorator-gen-31>", line 2, in _interpolator
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/firedrake/utils.py", line 90, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/firedrake/interpolation.py", line 1100, in _interpolator
    to_element = rebuild(to_element, expr, rt_var_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/functools.py", line 909, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/firedrake/interpolation.py", line 1298, in rebuild_dg
    rule = finat.quadrature.QuadratureRule(rule_pointset, weights=weights)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/finat/quadrature.py", line 123, in __init__
    self.weights = numpy.asarray(weights)
                   ^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
