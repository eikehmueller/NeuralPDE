2025-10-14 15:13:53,907 INFO     Running data_generator_swes.py
2025-10-14 15:13:56,792 ERROR    Gusto is logging this unhandled exception:
Traceback (most recent call last):
  File "petsc4py/PETSc/petscsnes.pxi", line 352, in petsc4py.PETSc.SNES_Function
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/firedrake/solving_utils.py", line 433, in form_function
    ctx._assemble_residual(tensor=ctx._F, current_state=ctx._x)
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/firedrake/assemble.py", line 1005, in assemble
    self.execute_parloops(tensor)
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/firedrake/assemble.py", line 1249, in execute_parloops
    parloop()
  File "petsc4py/PETSc/Log.pyx", line 250, in petsc4py.PETSc.Log.EventDecorator.decorator.wrapped_func
  File "petsc4py/PETSc/Log.pyx", line 251, in petsc4py.PETSc.Log.EventDecorator.decorator.wrapped_func
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/pyop2/parloop.py", line 251, in __call__
    self._compute(self.iterset.core_part)
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/pyop2/parloop.py", line 232, in _compute
    self.global_kernel(self.comm, part.offset, part.offset+part.size, *self.arglist)
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/pyop2/global_kernel.py", line 333, in __call__
    func(*args)
KeyboardInterrupt

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/katie795/NeuralPDE_workspace/NeuralPDE/src/data_generator_swes.py", line 98, in <module>
    dataset.prepare_for_model()
  File "/home/katie795/NeuralPDE_workspace/NeuralPDE/src/neural_pde/datasets.py", line 468, in prepare_for_model
    p.apply(w2, u_tar)    # target u data
    ^^^^^^^^^^^^^^^^^^
  File "/home/katie795/NeuralPDE_workspace/NeuralPDE/src/neural_pde/datasets.py", line 308, in apply
    self._lvs[j].solve()
  File "petsc4py/PETSc/Log.pyx", line 250, in petsc4py.PETSc.Log.EventDecorator.decorator.wrapped_func
  File "petsc4py/PETSc/Log.pyx", line 251, in petsc4py.PETSc.Log.EventDecorator.decorator.wrapped_func
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/firedrake/adjoint_utils/variational_solver.py", line 108, in wrapper
    out = solve(self, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/home/katie795/software/venv-firedrake/lib/python3.12/site-packages/firedrake/variational_solver.py", line 356, in solve
    self.snes.solve(None, work)
  File "petsc4py/PETSc/SNES.pyx", line 1738, in petsc4py.PETSc.SNES.solve
petsc4py.PETSc.Error: error code 101
[0] SNESSolve() at /home/katie795/software/petsc/src/snes/interface/snes.c:4846
[0] SNESSolve_KSPONLY() at /home/katie795/software/petsc/src/snes/impls/ksponly/ksponly.c:27
[0] SNESComputeFunction() at /home/katie795/software/petsc/src/snes/interface/snes.c:2476
